<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#7C3AED">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* Header */
        .header {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .header h1 { color: #7C3AED; font-size: 2rem; margin-bottom: 8px; }
        .header .date { color: #666; font-size: 1.1rem; }
        .header .time-info { 
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 0.9rem;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }
        .tab {
            flex: 1;
            padding: 12px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .tab.active {
            background: white;
            color: #7C3AED;
            font-weight: 600;
        }
        .tab:hover:not(.active) { background: rgba(255,255,255,0.3); }
        
        /* Content Panels */
        .panel { display: none; }
        .panel.active { display: block; }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .card h2 { color: #333; font-size: 1.3rem; margin-bottom: 16px; }
        .card h3 { color: #7C3AED; font-size: 1.1rem; margin: 16px 0 8px; }
        
        /* Task Item */
        .task {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }
        .task.completed { background: #d4edda; text-decoration: line-through; opacity: 0.7; }
        .task.drain { border-left: 4px solid #dc3545; }
        .task.neutral { border-left: 4px solid #ffc107; }
        .task.energize { border-left: 4px solid #28a745; }
        .task input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }
        .task-content { flex: 1; }
        .task-name { font-weight: 500; color: #333; }
        .task-meta { font-size: 0.85rem; color: #666; margin-top: 4px; }
        
        /* Study Resources */
        .study-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        .study-card h4 { margin-bottom: 8px; }
        .study-card a { color: #fff; text-decoration: underline; }
        .study-card .focus { 
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 6px;
            margin-top: 8px;
            font-size: 0.9rem;
        }
        
        /* Study Schedule Table */
        .study-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
        }
        .study-table th, .study-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        .study-table th { background: #f8f9fa; color: #7C3AED; }
        .study-table tr:hover { background: #f8f9fa; }
        .study-table .today { background: #e8f5e9; font-weight: 600; }
        
        /* Progress Bar */
        .progress-container { margin-bottom: 16px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .progress-bar {
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.5s;
        }
        
        /* Timer */
        .timer-container {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            margin-bottom: 16px;
        }
        .timer-display {
            font-size: 3rem;
            font-family: monospace;
            margin: 16px 0;
        }
        .timer-buttons { display: flex; gap: 12px; justify-content: center; }
        .timer-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s;
        }
        .timer-btn:hover { transform: scale(1.05); }
        .timer-btn.start { background: #28a745; color: white; }
        .timer-btn.stop { background: #dc3545; color: white; }
        .timer-btn.reset { background: #6c757d; color: white; }
        
        /* Quick Links */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }
        .quick-link {
            display: block;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            text-align: center;
            transition: all 0.3s;
        }
        .quick-link:hover { background: #7C3AED; color: white; transform: translateY(-2px); }
        .quick-link .icon { font-size: 1.5rem; margin-bottom: 8px; }

        /* Dark Mode Toggle */
        .dark-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            padding: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        .dark-toggle:hover { background: rgba(255,255,255,0.3); transform: scale(1.1); }

        /* Dark Mode Styles */
        body.dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        body.dark .header {
            background: #1e1e2f;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }
        body.dark .header h1 { color: #a78bfa; }
        body.dark .header .date { color: #9ca3af; }
        body.dark .card {
            background: #1e1e2f;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        body.dark .card h2 { color: #f3f4f6; }
        body.dark .task {
            background: #2d2d44;
        }
        body.dark .task.completed { background: #1e3a2f; }
        body.dark .task-name { color: #f3f4f6; }
        body.dark .task-meta { color: #9ca3af; }
        body.dark .study-table th { background: #2d2d44; color: #a78bfa; }
        body.dark .study-table td { color: #d1d5db; border-bottom-color: #374151; }
        body.dark .study-table tr:hover { background: #2d2d44; }
        body.dark .study-table .today { background: #1e3a2f; }
        body.dark .progress-bar { background: #374151; }
        body.dark .quick-link {
            background: #2d2d44;
            color: #d1d5db;
        }
        body.dark .quick-link:hover { background: #7C3AED; color: white; }
        body.dark .tab.active {
            background: #1e1e2f;
            color: #a78bfa;
        }
        body.dark .progress-label { color: #d1d5db; }
        body.dark #todayTasks p { color: #9ca3af; }
        body.dark #weekOverview > div {
            background: #2d2d44 !important;
            color: #d1d5db;
        }
    </style>
</head>
<body class="dark">
    <!-- Dark Mode Toggle -->
    <button class="dark-toggle" onclick="toggleDarkMode()" aria-label="Toggle theme">
        <span id="theme-icon">â˜€ï¸</span>
    </button>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ“… Weekly Planner</h1>
            <div class="date" id="currentDate">Loading...</div>
            <div class="time-info" id="timeInfo">
                ğŸŒ… Morning until 11am | ğŸŒ¤ï¸ Afternoon 12-5pm | ğŸŒ™ Evening 6-9pm
            </div>
        </div>
        
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showPanel('today')">ğŸ“‹ Today</button>
            <button class="tab" onclick="showPanel('week')">ğŸ“† Week</button>
            <button class="tab" onclick="showPanel('study')">ğŸ“š Study</button>
            <button class="tab" onclick="showPanel('timer')">â±ï¸ Timer</button>
        </div>
        
        <!-- Today Panel -->
        <div id="today" class="panel active">
            <div class="card">
                <h2>ğŸ¯ Today's Tasks</h2>
                <div id="todayTasks">
                    <!-- Tasks loaded dynamically -->
                </div>
            </div>
            
            <div class="card">
                <h2>ğŸ“Š Progress</h2>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Deep Work</span>
                        <span id="deepWorkProgress">0/4 hrs</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="deepWorkBar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Evening Study</span>
                        <span id="studyProgress">0/1.5 hrs</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="studyBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Week Panel -->
        <div id="week" class="panel">
            <div class="card">
                <h2>ğŸ“† Week Overview</h2>
                <div id="weekOverview">
                    <!-- Week loaded dynamically -->
                </div>
            </div>
        </div>
        
        <!-- Study Panel -->
        <div id="study" class="panel">
            <div class="card">
                <h2>ğŸ“š Evening Study Schedule</h2>
                <table class="study-table">
                    <thead>
                        <tr>
                            <th>Day</th>
                            <th>Hours</th>
                            <th>Focus</th>
                            <th>Platform</th>
                        </tr>
                    </thead>
                    <tbody id="studySchedule">
                        <!-- Loaded dynamically -->
                    </tbody>
                </table>
            </div>
            
            <div class="card">
                <h2>ğŸ”— Quick Access</h2>
                <div class="quick-links">
                    <a href="https://scrimba.com/the-backend-developer-path-c0tbi0l98f" target="_blank" class="quick-link">
                        <div class="icon">ğŸ¬</div>
                        <div>Scrimba</div>
                    </a>
                    <a href="https://www.datacamp.com" target="_blank" class="quick-link">
                        <div class="icon">ğŸ“Š</div>
                        <div>DataCamp</div>
                    </a>
                    <a href="https://roadmap.sh/backend" target="_blank" class="quick-link">
                        <div class="icon">ğŸ—ºï¸</div>
                        <div>Backend</div>
                    </a>
                    <a href="https://roadmap.sh/python" target="_blank" class="quick-link">
                        <div class="icon">ğŸ</div>
                        <div>Python</div>
                    </a>
                    <a href="https://roadmap.sh/system-design" target="_blank" class="quick-link">
                        <div class="icon">ğŸ—ï¸</div>
                        <div>System Design</div>
                    </a>
                    <a href="https://roadmap.sh/api-design" target="_blank" class="quick-link">
                        <div class="icon">ğŸ”Œ</div>
                        <div>API Design</div>
                    </a>
                </div>
            </div>
            
            <div class="study-card">
                <h4>ğŸ¯ Today's Study Focus</h4>
                <div id="todayStudyFocus" class="focus">Loading...</div>
            </div>
        </div>
        
        <!-- Timer Panel -->
        <div id="timer" class="panel">
            <div class="timer-container">
                <h3>â±ï¸ Focus Timer</h3>
                <div class="timer-display" id="timerDisplay">00:00:00</div>
                <div id="timerTask" style="margin-bottom: 16px; opacity: 0.8;">No task selected</div>
                <div class="timer-buttons">
                    <button class="timer-btn start" onclick="startTimer()">â–¶ï¸ Start</button>
                    <button class="timer-btn stop" onclick="stopTimer()">â¸ï¸ Pause</button>
                    <button class="timer-btn reset" onclick="resetTimer()">ğŸ”„ Reset</button>
                </div>
            </div>
            
            <div class="card">
                <h2>ğŸ“Š Today's Time Log</h2>
                <div id="timeLog">No time logged yet</div>
            </div>
        </div>
    </div>

    <script>
        // Study Schedule Data
        const studySchedule = [
            { day: 'Monday', hours: '1-1.5', focus: 'Python Foundations', platform: 'DataCamp â†’ Roadmap.sh' },
            { day: 'Tuesday', hours: '1-1.5', focus: 'Backend Architecture', platform: 'Roadmap.sh â†’ Scrimba' },
            { day: 'Wednesday', hours: '1.5', focus: 'Next.js + Node.js', platform: 'Scrimba (focused)' },
            { day: 'Thursday', hours: '1-1.5', focus: 'Data & Databases', platform: 'DataCamp â†’ Scrimba' },
            { day: 'Friday', hours: '2', focus: 'Integration & Review', platform: 'Mixed + Strategic' },
            { day: 'Saturday', hours: 'Optional', focus: 'Deep Dive Projects', platform: 'Scrimba projects' },
            { day: 'Sunday', hours: 'Optional', focus: 'Week Planning', platform: 'Claude + Planning' }
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateDateTime();
            loadStudySchedule();
            loadTasks();
            loadWeekOverview();
            setInterval(updateDateTime, 60000);
            loadTimerState();
        });
        
        function updateDateTime() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', options);
            
            // Check DST for time blocks
            const month = now.getMonth();
            const isDST = month >= 2 && month <= 10; // March to November
            
            if (isDST) {
                document.getElementById('timeInfo').innerHTML = 
                    'ğŸŒ… Morning until 1pm | ğŸŒ¤ï¸ Afternoon 1-6pm | ğŸŒ™ Evening 7-9pm';
            } else {
                document.getElementById('timeInfo').innerHTML = 
                    'ğŸŒ… Morning until 11am | ğŸŒ¤ï¸ Afternoon 12-5pm | ğŸŒ™ Evening 6-9pm';
            }
        }
        
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
            event.target.classList.add('active');
        }
        
        function loadStudySchedule() {
            const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });
            const tbody = document.getElementById('studySchedule');
            
            tbody.innerHTML = studySchedule.map(row => `
                <tr class="${row.day === today ? 'today' : ''}">
                    <td><strong>${row.day}</strong></td>
                    <td>${row.hours}</td>
                    <td>${row.focus}</td>
                    <td>${row.platform}</td>
                </tr>
            `).join('');
            
            // Update today's study focus
            const todayStudy = studySchedule.find(s => s.day === today);
            if (todayStudy) {
                document.getElementById('todayStudyFocus').innerHTML = 
                    `<strong>${todayStudy.focus}</strong><br>${todayStudy.platform}`;
            }
        }
        
        function loadTasks() {
            const saved = localStorage.getItem('weeklyTasks');
            let tasks = saved ? JSON.parse(saved) : getDefaultTasks();
            
            const today = new Date().toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            const todayTasks = tasks.filter(t => t.day === today);
            
            const container = document.getElementById('todayTasks');
            if (todayTasks.length === 0) {
                container.innerHTML = '<p style="color: #666;">No tasks for today. Add some!</p>';
                return;
            }
            
            container.innerHTML = todayTasks.map((task, i) => `
                <div class="task ${task.energy} ${task.completed ? 'completed' : ''}" data-id="${task.id}">
                    <input type="checkbox" ${task.completed ? 'checked' : ''} 
                           onchange="toggleTask('${task.id}')">
                    <div class="task-content">
                        <div class="task-name">${task.name}</div>
                        <div class="task-meta">
                            ${getEnergyEmoji(task.energy)} ${task.energy} â€¢ 
                            ${task.estimated}hr estimated
                        </div>
                    </div>
                </div>
            `).join('');
            
            updateProgress(todayTasks);
        }
        
        function getDefaultTasks() {
            return [
                { id: '1', day: 'monday', name: 'BIOptimizers Data Audit', energy: 'energize', estimated: 1, completed: false },
                { id: '2', day: 'monday', name: 'Google Ads GTM Setup', energy: 'drain', estimated: 2, completed: false },
                { id: '3', day: 'tuesday', name: 'Raise Your Hand Planning', energy: 'neutral', estimated: 2, completed: false },
                { id: '4', day: 'wednesday', name: 'PostHog Implementation', energy: 'drain', estimated: 2, completed: false },
            ];
        }
        
        function getEnergyEmoji(energy) {
            switch(energy) {
                case 'energize': return 'ğŸŸ¢';
                case 'neutral': return 'ğŸŸ¡';
                case 'drain': return 'ğŸ”´';
                default: return 'âšª';
            }
        }
        
        function toggleTask(id) {
            const saved = localStorage.getItem('weeklyTasks');
            let tasks = saved ? JSON.parse(saved) : getDefaultTasks();
            
            tasks = tasks.map(t => t.id === id ? {...t, completed: !t.completed} : t);
            localStorage.setItem('weeklyTasks', JSON.stringify(tasks));
            loadTasks();
        }
        
        function updateProgress(tasks) {
            const completed = tasks.filter(t => t.completed);
            const totalHours = tasks.reduce((sum, t) => sum + t.estimated, 0);
            const completedHours = completed.reduce((sum, t) => sum + t.estimated, 0);
            
            document.getElementById('deepWorkProgress').textContent = `${completedHours}/${totalHours} hrs`;
            document.getElementById('deepWorkBar').style.width = `${(completedHours/totalHours)*100}%`;
        }
        
        function loadWeekOverview() {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const saved = localStorage.getItem('weeklyTasks');
            let tasks = saved ? JSON.parse(saved) : getDefaultTasks();
            
            const container = document.getElementById('weekOverview');
            container.innerHTML = days.map(day => {
                const dayTasks = tasks.filter(t => t.day === day.toLowerCase());
                const completed = dayTasks.filter(t => t.completed).length;
                
                return `
                    <div style="padding: 12px; background: #f8f9fa; border-radius: 8px; margin-bottom: 8px;">
                        <strong>${day}</strong>
                        <span style="float: right; color: ${completed === dayTasks.length ? '#28a745' : '#666'}">
                            ${completed}/${dayTasks.length} tasks
                        </span>
                    </div>
                `;
            }).join('');
        }
        
        // Timer functionality
        let timerInterval = null;
        let timerSeconds = 0;
        
        function startTimer() {
            if (timerInterval) return;
            timerInterval = setInterval(() => {
                timerSeconds++;
                updateTimerDisplay();
                saveTimerState();
            }, 1000);
        }
        
        function stopTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            saveTimerState();
        }
        
        function resetTimer() {
            stopTimer();
            timerSeconds = 0;
            updateTimerDisplay();
            saveTimerState();
        }
        
        function updateTimerDisplay() {
            const hrs = Math.floor(timerSeconds / 3600);
            const mins = Math.floor((timerSeconds % 3600) / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = 
                `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        function saveTimerState() {
            localStorage.setItem('timerState', JSON.stringify({
                seconds: timerSeconds,
                running: timerInterval !== null,
                timestamp: Date.now()
            }));
        }
        
        function loadTimerState() {
            const saved = localStorage.getItem('timerState');
            if (saved) {
                const state = JSON.parse(saved);
                timerSeconds = state.seconds;
                updateTimerDisplay();
            }
        }
        
        // Dark Mode
        function toggleDarkMode() {
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            body.classList.toggle('dark');
            const isDark = body.classList.contains('dark');
            icon.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
            localStorage.setItem('plannerDarkMode', isDark ? 'true' : 'false');
        }

        function initDarkMode() {
            const savedMode = localStorage.getItem('plannerDarkMode');
            // Default to dark mode
            const shouldBeDark = savedMode !== 'false';

            if (shouldBeDark) {
                document.body.classList.add('dark');
                document.getElementById('theme-icon').textContent = 'â˜€ï¸';
            } else {
                document.body.classList.remove('dark');
                document.getElementById('theme-icon').textContent = 'ğŸŒ™';
            }
        }

        // Initialize dark mode
        initDarkMode();

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
